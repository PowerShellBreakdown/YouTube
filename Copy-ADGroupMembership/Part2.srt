1
00:00:02,719 --> 00:00:05,289
Hello and welcome to Part 2.

2
00:00:05,359 --> 00:00:06,429
In this video,

3
00:00:06,454 --> 00:00:08,758
we'll add an interactive selection window

4
00:00:08,783 --> 00:00:10,375
using <u>Out-GridView</u>

5
00:00:10,400 --> 00:00:13,094
to our script that finds the groups of one user

6
00:00:13,119 --> 00:00:16,281
and makes <i>another</i> user a member of those same groups.

7
00:00:19,984 --> 00:00:22,656
If we compare the finished script, here,

8
00:00:22,758 --> 00:00:24,820
with the one from Part 1,

9
00:00:24,845 --> 00:00:27,250
we can see two changes:

10
00:00:28,031 --> 00:00:29,055
First,

11
00:00:29,080 --> 00:00:31,930
The SAM account names of Michelle and Paul

12
00:00:31,955 --> 00:00:34,484
are assigned to variables at the very top.

13
00:00:35,164 --> 00:00:36,797
Any user-defined variables

14
00:00:36,822 --> 00:00:38,023
should be at the top

15
00:00:38,048 --> 00:00:39,570
to make it easier to find

16
00:00:39,595 --> 00:00:41,977
for anyone making changes to the script.

17
00:00:43,625 --> 00:00:45,883
Our script here is fairly simple

18
00:00:45,908 --> 00:00:48,391
and these SAM account names <i>are</i> easy to find,

19
00:00:48,758 --> 00:00:50,898
but you could probably imagine the ordeal

20
00:00:50,923 --> 00:00:52,539
in a script that has hundreds

21
00:00:52,564 --> 00:00:54,219
or thousands of lines of code.

22
00:00:54,244 --> 00:00:56,570
So it's a good habit to get into.

23
00:00:57,844 --> 00:00:58,898
The second change,

24
00:00:58,923 --> 00:01:00,930
is that we've added <u>Out-GridView</u>

25
00:01:01,258 --> 00:01:03,023
to filter/select groups

26
00:01:03,048 --> 00:01:06,109
before assigning to the <u>$SelectedGroups</u> variable.

27
00:01:08,672 --> 00:01:10,805
This feature is added to the script

28
00:01:10,830 --> 00:01:12,391
because there <i>are</i> scenarios

29
00:01:12,416 --> 00:01:13,851
in which an administrator

30
00:01:13,859 --> 00:01:15,891
blindly copying group membership

31
00:01:15,916 --> 00:01:17,656
would be a <i>huge</i> problem.

32
00:01:18,305 --> 00:01:20,320
Let's say that user Michelle Adams

33
00:01:20,345 --> 00:01:22,531
is now a supervisor of the Sales team

34
00:01:22,556 --> 00:01:23,781
at the Breakdown Lab

35
00:01:23,859 --> 00:01:26,516
and has access to a restricted network folder

36
00:01:26,541 --> 00:01:28,883
via the 'Sales Supervisors' group.

37
00:01:29,930 --> 00:01:31,273
Our new user, Paul,

38
00:01:31,298 --> 00:01:34,172
should not have access to <i>this specific</i> folder,

39
00:01:34,197 --> 00:01:35,664
but <i>should</i> have access

40
00:01:35,689 --> 00:01:38,180
to all other network folders for the Sales team.

41
00:01:38,695 --> 00:01:40,828
We still want to leverage PowerShell

42
00:01:40,853 --> 00:01:42,281
to help automate this task

43
00:01:42,306 --> 00:01:44,258
but also want to have an adminstrator

44
00:01:44,283 --> 00:01:45,492
filter out any groups

45
00:01:45,517 --> 00:01:48,094
that may not be appropriate for our new user.

46
00:01:49,063 --> 00:01:51,781
This is where <u>Out-GridView</u> is very useful.

47
00:01:52,391 --> 00:01:54,000
What <u>Out-GridView</u> does

48
00:01:54,025 --> 00:01:55,992
is display a PowerShell object

49
00:01:56,017 --> 00:01:57,820
in an interactive table.

50
00:01:58,461 --> 00:01:59,695
To show a quick example

51
00:01:59,720 --> 00:02:02,406
of how the grid view displays a PowerShell object,

52
00:02:02,563 --> 00:02:03,883
we'll use the <u>Get-ADUser</u> command

53
00:02:03,908 --> 00:02:05,656
from the previous video.

54
00:02:06,648 --> 00:02:07,359
We'll type:

55
00:02:07,384 --> 00:02:12,328
Get-ADUser -Identity michelle.adams

56
00:02:12,609 --> 00:02:15,102
Compare that to the grid view output

57
00:02:15,127 --> 00:02:17,695
by piping the command into <u>Out-GridView</u>.

58
00:02:25,320 --> 00:02:27,781
We can see that the output displays the properties

59
00:02:27,806 --> 00:02:31,367
Distinguished Name, Enabled, Name, and so on.

60
00:02:31,844 --> 00:02:34,938
And those are the same in the window columns.

61
00:02:37,344 --> 00:02:40,813
To get a full appreciation of what <u>Out-GridView</u> can do,

62
00:02:40,891 --> 00:02:43,445
let's try it will all AD users.

63
00:02:44,000 --> 00:02:44,867
Type:

64
00:02:44,892 --> 00:02:50,805
Get-ADUser -Filter * | Out-GridView

65
00:02:51,945 --> 00:02:54,891
Now that we have many results with multiple properties,

66
00:02:54,916 --> 00:02:58,172
we can begin to explore the features of the grid view window.

67
00:02:59,469 --> 00:03:01,977
The grid view window has many features.

68
00:03:02,086 --> 00:03:04,383
One of them is that you can sort the rows

69
00:03:04,408 --> 00:03:06,109
by clicking on the column header.

70
00:03:06,781 --> 00:03:07,906
On the first click,

71
00:03:07,931 --> 00:03:09,789
you will see a small "up" arrow

72
00:03:09,814 --> 00:03:13,070
indicating that the rows are sorted in <i>acending</i> order,

73
00:03:13,414 --> 00:03:14,188
that is,

74
00:03:14,213 --> 00:03:15,648
A-Z alphabetically

75
00:03:15,673 --> 00:03:17,648
or small to large numerically.

76
00:03:18,359 --> 00:03:19,703
On the second click,

77
00:03:19,728 --> 00:03:22,242
the small arrow will change from up to down

78
00:03:22,267 --> 00:03:25,648
indicating that the rows are sorted in <i>decending</i> order,

79
00:03:25,680 --> 00:03:28,727
that is Z-A reverse alphabetically

80
00:03:28,752 --> 00:03:30,664
or large to small numerically.

81
00:03:31,133 --> 00:03:33,070
If you want to hide a column,

82
00:03:33,095 --> 00:03:35,109
right-click on a column header

83
00:03:35,134 --> 00:03:37,602
and select <u>Select Columns...</u>

84
00:03:37,828 --> 00:03:39,672
From the <u>Selected Columns</u> box,

85
00:03:39,697 --> 00:03:41,180
select a column name

86
00:03:41,205 --> 00:03:43,359
and click on the double left arrow button

87
00:03:43,384 --> 00:03:44,500
and hit OK

88
00:03:44,525 --> 00:03:46,508
and it'll be removed from the window.

89
00:03:47,570 --> 00:03:49,102
This field at the top

90
00:03:49,141 --> 00:03:50,633
is called "Quick Filter"

91
00:03:50,658 --> 00:03:51,906
and it will search all properties

92
00:03:51,931 --> 00:03:53,250
of the PowerShell objects

93
00:03:53,275 --> 00:03:54,578
displayed in the window

94
00:03:54,603 --> 00:03:56,258
that matches the typed pattern.

95
00:03:56,734 --> 00:03:58,953
If we type M-I-C-H

96
00:03:58,978 --> 00:04:01,539
it would find both Michelle and Michael

97
00:04:01,564 --> 00:04:02,820
because their Given Names

98
00:04:02,845 --> 00:04:05,375
both begin with M-I-C-H.

99
00:04:06,883 --> 00:04:09,023
To search a specific property,

100
00:04:09,048 --> 00:04:10,883
click the <u>Add criteria</u> button

101
00:04:10,908 --> 00:04:13,375
and check the box for the property to search.

102
00:04:13,400 --> 00:04:15,953
In this case, select <u>Surname</u>.

103
00:04:16,000 --> 00:04:19,688
(Surname is another name for Last Name or Family Name)

104
00:04:19,734 --> 00:04:21,250
and click <u>Add</u>.

105
00:04:21,945 --> 00:04:24,102
We'll leave the selection on <u>contains</u>,

106
00:04:24,127 --> 00:04:26,336
but you have other filtering options.

107
00:04:28,430 --> 00:04:30,641
Type in the Last Name, "Adams".

108
00:04:30,672 --> 00:04:33,672
Now only Michelle Adams is shown in the results.

109
00:04:34,539 --> 00:04:36,180
When you want to pass the selction

110
00:04:36,205 --> 00:04:38,328
from a grid view window to the console,

111
00:04:38,353 --> 00:04:40,789
you'll use the <u>-PassThru</u> parameter.

112
00:04:41,914 --> 00:04:44,625
Now, whenever we select a user and hit OK,

113
00:04:44,650 --> 00:04:47,570
the object is then output to the console.

114
00:04:48,188 --> 00:04:50,180
You can output multiple users

115
00:04:50,205 --> 00:04:52,555
by holding the "Control" key while clicking.

116
00:04:52,797 --> 00:04:56,695
All selected users are then output to the console.

117
00:05:00,086 --> 00:05:03,219
Note: hiding columns in the grid view window

118
00:05:03,244 --> 00:05:06,031
does not affect the object during pass thru.

119
00:05:11,398 --> 00:05:12,992
To give the window a title,

120
00:05:13,017 --> 00:05:15,172
use the <u>-Title</u> parameter.

121
00:05:21,359 --> 00:05:23,211
<i>("O'Doyle Rules!" from <u>Billy Madison</u>)</i>

122
00:05:24,781 --> 00:05:28,297
Here is how we've used it in the script.

123
00:05:29,086 --> 00:05:30,602
For those with a keen eye,

124
00:05:30,627 --> 00:05:32,945
you'll have noticed that we've used double-quotes ( " )

125
00:05:33,094 --> 00:05:34,688
instead of single quotes ( ' )

126
00:05:34,713 --> 00:05:36,969
for the grid view window title text.

127
00:05:37,523 --> 00:05:40,047
When using a variable in a text string,

128
00:05:40,072 --> 00:05:43,602
double-quotes are used to display the value of the variable,

129
00:05:43,633 --> 00:05:46,742
and single quotes are used to display the literal text.

130
00:05:48,391 --> 00:05:49,773
Here's the text displaying

131
00:05:49,798 --> 00:05:52,391
the target user variable with single quotes.

132
00:05:53,602 --> 00:05:57,070
and the text displaying target user variable with double quotes

133
00:06:00,195 --> 00:06:02,781
<i>("Enough Talk!" from <u>Conan the Destroyer</u>)</i>

134
00:06:03,578 --> 00:06:06,141
This time instead of using run selection,

135
00:06:06,166 --> 00:06:09,227
I'll type the name of the script file from PowerShell.

136
00:06:10,836 --> 00:06:13,758
I'll then control + click the groups to add Paul to,

137
00:06:13,783 --> 00:06:15,992
leaving out the Sales Supervisors group,

138
00:06:16,017 --> 00:06:17,359
and hit OK.

139
00:06:18,859 --> 00:06:21,813
Verify the results in ADUC.

140
00:06:25,820 --> 00:06:29,281
Paul Allen now is a member of all of Michelle's groups,

141
00:06:29,306 --> 00:06:31,305
except the "Sales Supervisors" group.

142
00:06:33,984 --> 00:06:35,977
This concludes Part 2.

143
00:06:36,002 --> 00:06:38,266
As always, the script as shown

144
00:06:38,291 --> 00:06:40,563
and the write-up will be uploaded to my GitHub

145
00:06:40,588 --> 00:06:42,086
which is linked in the description.

146
00:06:43,031 --> 00:06:45,727
Thank you for watching, and I hoped you learned something.

